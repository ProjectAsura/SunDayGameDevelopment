//-----------------------------------------------------------------------------
// File : Block.h
// Desc : Block Gimmick
// Copyright(c) Project Asura. All right reserved.
//-----------------------------------------------------------------------------
#pragma once

//-----------------------------------------------------------------------------
// Includes
//-----------------------------------------------------------------------------
#include <Gimmick.h>


///////////////////////////////////////////////////////////////////////////////
// Block class
///////////////////////////////////////////////////////////////////////////////
class Block : public Gimmick
{
    //=========================================================================
    // list of friend classes and methods.
    //=========================================================================
    /* NOTHING */

public:
    //=========================================================================
    // public variables.
    //=========================================================================
    /* NOTHING */

    //=========================================================================
    // public methods.
    //=========================================================================

    //-------------------------------------------------------------------------
    //! @brief      コンストラクタです.
    //-------------------------------------------------------------------------
    Block();

    //-------------------------------------------------------------------------
    //! @brief      デストラクタです.
    //-------------------------------------------------------------------------
    ~Block();

    //-------------------------------------------------------------------------
    //! @brief      フラグと位置をリセットします.
    //-------------------------------------------------------------------------
    void Reset() override;

    //-------------------------------------------------------------------------
    //! @brief      可動方向を指定します.
    //-------------------------------------------------------------------------
    void SetDir(DIRECTION_STATE dir);

    //-------------------------------------------------------------------------
    //! @brief      プレイヤーが移動可能かチェックします.
    //-------------------------------------------------------------------------
    bool CanMove(const Box& playerBox) override;

    //-------------------------------------------------------------------------
    //! @brief      更新処理を行います.
    //-------------------------------------------------------------------------
    void Update(UpdateContext& context) override;

    //-------------------------------------------------------------------------
    //! @brief      メッセージ受信処理を行います.
    //-------------------------------------------------------------------------
    void OnReceive(const Message& msg) override;

private:
    //=========================================================================
    // private variables.
    //=========================================================================
    uint8_t                     m_Frame     = 0;
    bool                        m_CurrHit   = false;
    bool                        m_PrevHit   = false;
    DIRECTION_STATE             m_Dir       = DIRECTION_NONE;
    DIRECTION_STATE             m_InitDir   = DIRECTION_NONE;
    int                         m_Moved     = 0;

    //=========================================================================
    // private methods.
    //=========================================================================
    /* NOTHING */
};