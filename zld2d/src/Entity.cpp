//-----------------------------------------------------------------------------
// File : Entity.cpp
// Desc : Game Object.
// Copyright(c) Project Asura. All right reserved.
//-----------------------------------------------------------------------------

//-----------------------------------------------------------------------------
// Includes
//------------------------------------------------------------------------------
#include <Entity.h>
#include <cassert>


///////////////////////////////////////////////////////////////////////////////
// EntityMgr class
///////////////////////////////////////////////////////////////////////////////
EntityMgr EntityMgr::s_Instance;

//-----------------------------------------------------------------------------
//      シングルトンインスタンスを取得します.
//-----------------------------------------------------------------------------
EntityMgr& EntityMgr::Instance()
{ return s_Instance; }

//-----------------------------------------------------------------------------
//      エンティティを破棄します.
//-----------------------------------------------------------------------------
void EntityMgr::Clear()
{ m_Entities.clear(); }

//-----------------------------------------------------------------------------
//      エンティティを追加します.
//-----------------------------------------------------------------------------
void EntityMgr::Add(uint32_t id, IEntity* object)
{
    assert(!Contains(id));
    m_Entities[id] = object;
}

//-----------------------------------------------------------------------------
//      エンティティを削除します.
//-----------------------------------------------------------------------------
void EntityMgr::Remove(uint32_t id)
{
    if (!Contains(id))
    { return; }

    m_Entities.erase(id);
}

//-----------------------------------------------------------------------------
//      エンティティを保持するかチェックします.
//-----------------------------------------------------------------------------
bool EntityMgr::Contains(uint32_t id) const
{ return m_Entities.find(id) != m_Entities.end(); }

//-----------------------------------------------------------------------------
//      メッセージを送信します.
//-----------------------------------------------------------------------------
void EntityMgr::Send(const Message& msg)
{
    for(auto& itr : m_Entities)
    { itr.second->OnReceive(msg); }
}
